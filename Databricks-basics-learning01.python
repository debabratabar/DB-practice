{"cells":[{"cell_type":"markdown","source":["### Read and write using python"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"312f71d9-5553-4981-8bdc-03f83a1d73f1"}}},{"cell_type":"code","source":["#storage account details\nstorage_account_name=\"synapsestorage1st\"\ncontainer_name=\"spark-data\"\nstorage_account_access_key=\"WLs88CucPJ0C+vWwF1Hg3TeXuYgdG2puMHta/q9KL1G1Q6qVAa2Cdt5/l//IPgBYMkAw237IedWi+AStQ4AmuQ==\"\nspark.conf.set('fs.azure.account.key.' + storage_account_name + '.blob.core.windows.net', storage_account_access_key)\nfilepath=\"wasbs://\"+container_name+\"@\"+storage_account_name+\".blob.core.windows.net/email_data.csv/\""],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"51143d38-9a87-4a87-99ad-dff889bd953c"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\"></div>","removedWidgets":[],"addedWidgets":{},"metadata":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"></div>"]}}],"execution_count":0},{"cell_type":"code","source":["#reading file from blob\nfile_df= spark.read.csv(filepath  , header=\"true\" , inferSchema = \"true\")"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"ac472a7b-b76e-4c02-bcee-8567dbe2f505"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\"></div>","removedWidgets":[],"addedWidgets":{},"metadata":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"></div>"]}}],"execution_count":0},{"cell_type":"code","source":["#printing the dataframe\nfile_df.show()"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"c29c0005-b8e0-40bd-9930-03e483a63bb2"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\">+-----------+--------+-------------------+--------------+----------+-----------------------+---------------------+--------------------+\n|marketoGUID|  leadId|       activityDate|activityTypeId|campaignId|primaryAttributeValueId|primaryAttributeValue|          attributes|\n+-----------+--------+-------------------+--------------+----------+-----------------------+---------------------+--------------------+\n|  862946360|16105144|2022-07-09 17:39:34|            27|      6906|                   2882| US-VRA-210401 VRA...|&#34;{&#34;&#34;Campaign Run ...|\n|  862949883|15773134|2022-07-09 17:53:48|            10|      6906|                   2882| US-VRA-210401 VRA...|&#34;{&#34;&#34;Campaign Run ...|\n|  863306120| 1021127|2022-07-11 04:44:38|            11|      6085|                   2887| 202206 - US-BYS-2...|&#34;{&#34;&#34;Campaign Run ...|\n|  863376700|44162663|2022-07-11 10:48:27|            11|      6350|                   2676| 202206 - US-QLP-2...|&#34;{&#34;&#34;Campaign Run ...|\n|  864005619|12044596|2022-07-11 16:17:52|             6|      6291|                   2729| 202206-US-DAV-220...|&#34;{&#34;&#34;Campaign Run ...|\n+-----------+--------+-------------------+--------------+----------+-----------------------+---------------------+--------------------+\n\n</div>","removedWidgets":[],"addedWidgets":{},"metadata":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">+-----------+--------+-------------------+--------------+----------+-----------------------+---------------------+--------------------+\nmarketoGUID|  leadId|       activityDate|activityTypeId|campaignId|primaryAttributeValueId|primaryAttributeValue|          attributes|\n+-----------+--------+-------------------+--------------+----------+-----------------------+---------------------+--------------------+\n  862946360|16105144|2022-07-09 17:39:34|            27|      6906|                   2882| US-VRA-210401 VRA...|&#34;{&#34;&#34;Campaign Run ...|\n  862949883|15773134|2022-07-09 17:53:48|            10|      6906|                   2882| US-VRA-210401 VRA...|&#34;{&#34;&#34;Campaign Run ...|\n  863306120| 1021127|2022-07-11 04:44:38|            11|      6085|                   2887| 202206 - US-BYS-2...|&#34;{&#34;&#34;Campaign Run ...|\n  863376700|44162663|2022-07-11 10:48:27|            11|      6350|                   2676| 202206 - US-QLP-2...|&#34;{&#34;&#34;Campaign Run ...|\n  864005619|12044596|2022-07-11 16:17:52|             6|      6291|                   2729| 202206-US-DAV-220...|&#34;{&#34;&#34;Campaign Run ...|\n+-----------+--------+-------------------+--------------+----------+-----------------------+---------------------+--------------------+\n\n</div>"]}}],"execution_count":0},{"cell_type":"code","source":["#creating a hive managed table   in databricks from this csv file \nfile_df.write.saveAsTable('email_data_managed_table')"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"afbd275b-be83-4926-a748-228f6c19800e"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\"></div>","removedWidgets":[],"addedWidgets":{},"metadata":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"></div>"]}}],"execution_count":0},{"cell_type":"markdown","source":["N0te that the table 'email_data_managed_table' will be stored in default location \"dbfs:user/hive/warehouse/\""],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"2c3ba350-3ab1-4046-8706-a7ecda5eb2f8"}}},{"cell_type":"code","source":["%sql\n--to check the table details\ndescribe extended email_data_managed_table"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"08f66b6b-48d1-463e-9a06-7bdbefd3d667"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"overflow":false,"datasetInfos":[],"data":[["marketoGUID","int",""],["leadId","int",""],["activityDate","timestamp",""],["activityTypeId","int",""],["campaignId","int",""],["primaryAttributeValueId","int",""],["primaryAttributeValue","string",""],["attributes","string",""],["","",""],["# Partitioning","",""],["Not partitioned","",""],["","",""],["# Detailed Table Information","",""],["Catalog","spark_catalog",""],["Database","default",""],["Table","email_data_managed_table",""],["Location","dbfs:/user/hive/warehouse/email_data_managed_table",""],["Provider","delta",""],["Owner","root",""],["Is_managed_location","true",""],["Type","MANAGED",""],["Table Properties","[delta.minReaderVersion=1,delta.minWriterVersion=2]",""]],"plotOptions":{"displayType":"table","customPlotOptions":{},"pivotColumns":null,"pivotAggregation":null,"xColumns":null,"yColumns":null},"columnCustomDisplayInfos":{},"aggType":"","isJsonSchema":true,"removedWidgets":[],"aggSchema":[],"schema":[{"name":"col_name","type":"\"string\"","metadata":"{\"comment\":\"name of the column\"}"},{"name":"data_type","type":"\"string\"","metadata":"{\"comment\":\"data type of the column\"}"},{"name":"comment","type":"\"string\"","metadata":"{\"comment\":\"comment of the column\"}"}],"aggError":"","aggData":[],"addedWidgets":{},"metadata":{"isDbfsCommandResult":false},"dbfsResultPath":null,"type":"table","aggOverflow":false,"aggSeriesLimitReached":false,"arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .table-result-container {\n    max-height: 300px;\n    overflow: auto;\n  }\n  table, th, td {\n    border: 1px solid black;\n    border-collapse: collapse;\n  }\n  th, td {\n    padding: 5px;\n  }\n  th {\n    text-align: left;\n  }\n</style><div class='table-result-container'><table class='table-result'><thead style='background-color: white'><tr><th>col_name</th><th>data_type</th><th>comment</th></tr></thead><tbody><tr><td>marketoGUID</td><td>int</td><td></td></tr><tr><td>leadId</td><td>int</td><td></td></tr><tr><td>activityDate</td><td>timestamp</td><td></td></tr><tr><td>activityTypeId</td><td>int</td><td></td></tr><tr><td>campaignId</td><td>int</td><td></td></tr><tr><td>primaryAttributeValueId</td><td>int</td><td></td></tr><tr><td>primaryAttributeValue</td><td>string</td><td></td></tr><tr><td>attributes</td><td>string</td><td></td></tr><tr><td></td><td></td><td></td></tr><tr><td># Partitioning</td><td></td><td></td></tr><tr><td>Not partitioned</td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr><tr><td># Detailed Table Information</td><td></td><td></td></tr><tr><td>Catalog</td><td>spark_catalog</td><td></td></tr><tr><td>Database</td><td>default</td><td></td></tr><tr><td>Table</td><td>email_data_managed_table</td><td></td></tr><tr><td>Location</td><td>dbfs:/user/hive/warehouse/email_data_managed_table</td><td></td></tr><tr><td>Provider</td><td>delta</td><td></td></tr><tr><td>Owner</td><td>root</td><td></td></tr><tr><td>Is_managed_location</td><td>true</td><td></td></tr><tr><td>Type</td><td>MANAGED</td><td></td></tr><tr><td>Table Properties</td><td>[delta.minReaderVersion=1,delta.minWriterVersion=2]</td><td></td></tr></tbody></table></div>"]}}],"execution_count":0},{"cell_type":"markdown","source":["### Read and write using sql"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"9981054f-12ea-4b44-b315-8e35a268745e"}}},{"cell_type":"code","source":["#storage account details\nstorage_account_name=\"synapsestorage1st\"\ncontainer_name=\"spark-data\"\nstorage_account_access_key=\"WLs88CucPJ0C+vWwF1Hg3TeXuYgdG2puMHta/q9KL1G1Q6qVAa2Cdt5/l//IPgBYMkAw237IedWi+AStQ4AmuQ==\"\nspark.conf.set('fs.azure.account.key.' + storage_account_name + '.blob.core.windows.net', storage_account_access_key)\nfilepath=\"wasbs://\"+container_name+\"@\"+storage_account_name+\".blob.core.windows.net/email_data.csv/\""],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"d7e52af1-54a5-4ae2-8664-0c9b6f434144"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\"></div>","removedWidgets":[],"addedWidgets":{},"metadata":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"></div>"]}}],"execution_count":0},{"cell_type":"code","source":["print(filepath)"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"2ad083b7-36a8-4375-8528-f7837140eab1"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\">wasbs://spark-data@synapsestorage1st.blob.core.windows.net/email_data.csv/\n</div>","removedWidgets":[],"addedWidgets":{},"metadata":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">wasbs://spark-data@synapsestorage1st.blob.core.windows.net/email_data.csv/\n</div>"]}}],"execution_count":0},{"cell_type":"code","source":["#after setting the filepath we have to configure the path with a new name\n\nspark.conf.set(\"source-file-path\", filepath)\n"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"51f933bd-dfcb-4107-8358-a0a7200d39e6"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\"></div>","removedWidgets":[],"addedWidgets":{},"metadata":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"></div>"]}}],"execution_count":0},{"cell_type":"code","source":["%sql\n-- first create a schema/ database \ncreate schema if not exists database_practice "],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"1984ce65-128c-413b-932a-e1908a1f1ad5"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"overflow":false,"datasetInfos":[],"data":[],"plotOptions":{"displayType":"table","customPlotOptions":{},"pivotColumns":null,"pivotAggregation":null,"xColumns":null,"yColumns":null},"columnCustomDisplayInfos":{},"aggType":"","isJsonSchema":true,"removedWidgets":[],"aggSchema":[],"schema":[],"aggError":"","aggData":[],"addedWidgets":{},"metadata":{"isDbfsCommandResult":false},"dbfsResultPath":null,"type":"table","aggOverflow":false,"aggSeriesLimitReached":false,"arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .table-result-container {\n    max-height: 300px;\n    overflow: auto;\n  }\n  table, th, td {\n    border: 1px solid black;\n    border-collapse: collapse;\n  }\n  th, td {\n    padding: 5px;\n  }\n  th {\n    text-align: left;\n  }\n</style><div class='table-result-container'><table class='table-result'><thead style='background-color: white'><tr></tr></thead><tbody></tbody></table></div>"]}}],"execution_count":0},{"cell_type":"code","source":["%sql\nselect \"${source-file-path}\" as file_path"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"8cb24be8-a1f0-44f4-875c-37ada20dfb50"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"overflow":false,"datasetInfos":[],"data":[["wasbs://spark-data@synapsestorage1st.blob.core.windows.net/email_data.csv/"]],"plotOptions":{"displayType":"table","customPlotOptions":{},"pivotColumns":null,"pivotAggregation":null,"xColumns":null,"yColumns":null},"columnCustomDisplayInfos":{},"aggType":"","isJsonSchema":true,"removedWidgets":[],"aggSchema":[],"schema":[{"name":"file_path","type":"\"string\"","metadata":"{}"}],"aggError":"","aggData":[],"addedWidgets":{},"metadata":{"isDbfsCommandResult":false},"dbfsResultPath":null,"type":"table","aggOverflow":false,"aggSeriesLimitReached":false,"arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .table-result-container {\n    max-height: 300px;\n    overflow: auto;\n  }\n  table, th, td {\n    border: 1px solid black;\n    border-collapse: collapse;\n  }\n  th, td {\n    padding: 5px;\n  }\n  th {\n    text-align: left;\n  }\n</style><div class='table-result-container'><table class='table-result'><thead style='background-color: white'><tr><th>file_path</th></tr></thead><tbody><tr><td>wasbs://spark-data@synapsestorage1st.blob.core.windows.net/email_data.csv/</td></tr></tbody></table></div>"]}}],"execution_count":0},{"cell_type":"code","source":["%sql\n-- first creating a view to create a table , \ncreate temporary view temp_email_data\nusing csv \noptions(\npath=\"${source-file-path}\",\nheader= \"true\",\ninferschema= \"true\");\n"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"b412d752-d94b-455a-9543-77d402fdaf56"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"overflow":false,"datasetInfos":[],"data":[],"plotOptions":{"displayType":"table","customPlotOptions":{},"pivotColumns":null,"pivotAggregation":null,"xColumns":null,"yColumns":null},"columnCustomDisplayInfos":{},"aggType":"","isJsonSchema":true,"removedWidgets":[],"aggSchema":[],"schema":[],"aggError":"","aggData":[],"addedWidgets":{},"metadata":{"isDbfsCommandResult":false},"dbfsResultPath":null,"type":"table","aggOverflow":false,"aggSeriesLimitReached":false,"arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .table-result-container {\n    max-height: 300px;\n    overflow: auto;\n  }\n  table, th, td {\n    border: 1px solid black;\n    border-collapse: collapse;\n  }\n  th, td {\n    padding: 5px;\n  }\n  th {\n    text-align: left;\n  }\n</style><div class='table-result-container'><table class='table-result'><thead style='background-color: white'><tr></tr></thead><tbody></tbody></table></div>"]}}],"execution_count":0},{"cell_type":"code","source":["%sql\n-- creating a table from a temporary view\ncreate table if not exists email_data_using_sql\nAs\nselect * from temp_email_data"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"2cb7de7d-dd22-4d10-9c08-ac90ca788ead"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"overflow":false,"datasetInfos":[],"data":[],"plotOptions":{"displayType":"table","customPlotOptions":{},"pivotColumns":null,"pivotAggregation":null,"xColumns":null,"yColumns":null},"columnCustomDisplayInfos":{},"aggType":"","isJsonSchema":true,"removedWidgets":[],"aggSchema":[],"schema":[{"name":"num_affected_rows","type":"\"long\"","metadata":"{}"},{"name":"num_inserted_rows","type":"\"long\"","metadata":"{}"}],"aggError":"","aggData":[],"addedWidgets":{},"metadata":{"isDbfsCommandResult":false},"dbfsResultPath":null,"type":"table","aggOverflow":false,"aggSeriesLimitReached":false,"arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .table-result-container {\n    max-height: 300px;\n    overflow: auto;\n  }\n  table, th, td {\n    border: 1px solid black;\n    border-collapse: collapse;\n  }\n  th, td {\n    padding: 5px;\n  }\n  th {\n    text-align: left;\n  }\n</style><div class='table-result-container'><table class='table-result'><thead style='background-color: white'><tr><th>num_affected_rows</th><th>num_inserted_rows</th></tr></thead><tbody></tbody></table></div>"]}}],"execution_count":0},{"cell_type":"code","source":["%sql\n-- checking the data\nselect * from email_data_using_sql"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"2b64f67e-d755-48df-8797-fdfc5cde69fd"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"overflow":false,"datasetInfos":[],"data":[[862946360,16105144,"2022-07-09T17:39:34.000+0000",27,6906,2882,"US-VRA-210401 VRA145087_VRAYLAR Metabolics Enterprise NRW Email - Updated.US-VRA-210401 VRA145087_VRAYLAR Metabolics Enterprise Email - Updated","\"{\"\"Campaign Run ID\"\":\"\"10171\"\""],[862949883,15773134,"2022-07-09T17:53:48.000+0000",10,6906,2882,"US-VRA-210401 VRA145087_VRAYLAR Metabolics Enterprise NRW Email - Updated.US-VRA-210401 VRA145087_VRAYLAR Metabolics Enterprise Email - Updated","\"{\"\"Campaign Run ID\"\":\"\"10171\"\""],[863306120,1021127,"2022-07-11T04:44:38.000+0000",11,6085,2887,"202206 - US-BYS-220002.US-BYS-220002 - Bystolic Savings Program HCP Email","\"{\"\"Campaign Run ID\"\":\"\"10106\"\""],[863376700,44162663,"2022-07-11T10:48:27.000+0000",11,6350,2676,"202206 - US-QLP-220036.US-QLP-220036 ABV-HCP-ATP-001752-2-CRM-5","\"{\"\"Campaign Run ID\"\":\"\"10215\"\""],[864005619,12044596,"2022-07-11T16:17:52.000+0000",6,6291,2729,"202206-US-DAV-220056-AHE-Dalvance Copay Email.US-DAV-220056 Copay Assistance Program CRM Email (DLV) 1","\"{\"\"Campaign Run ID\"\":10232"]],"plotOptions":{"displayType":"table","customPlotOptions":{},"pivotColumns":null,"pivotAggregation":null,"xColumns":null,"yColumns":null},"columnCustomDisplayInfos":{},"aggType":"","isJsonSchema":true,"removedWidgets":[],"aggSchema":[],"schema":[{"name":"marketoGUID","type":"\"integer\"","metadata":"{}"},{"name":"leadId","type":"\"integer\"","metadata":"{}"},{"name":"activityDate","type":"\"timestamp\"","metadata":"{}"},{"name":"activityTypeId","type":"\"integer\"","metadata":"{}"},{"name":"campaignId","type":"\"integer\"","metadata":"{}"},{"name":"primaryAttributeValueId","type":"\"integer\"","metadata":"{}"},{"name":"primaryAttributeValue","type":"\"string\"","metadata":"{}"},{"name":"attributes","type":"\"string\"","metadata":"{}"}],"aggError":"","aggData":[],"addedWidgets":{},"metadata":{"isDbfsCommandResult":false},"dbfsResultPath":null,"type":"table","aggOverflow":false,"aggSeriesLimitReached":false,"arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .table-result-container {\n    max-height: 300px;\n    overflow: auto;\n  }\n  table, th, td {\n    border: 1px solid black;\n    border-collapse: collapse;\n  }\n  th, td {\n    padding: 5px;\n  }\n  th {\n    text-align: left;\n  }\n</style><div class='table-result-container'><table class='table-result'><thead style='background-color: white'><tr><th>marketoGUID</th><th>leadId</th><th>activityDate</th><th>activityTypeId</th><th>campaignId</th><th>primaryAttributeValueId</th><th>primaryAttributeValue</th><th>attributes</th></tr></thead><tbody><tr><td>862946360</td><td>16105144</td><td>2022-07-09T17:39:34.000+0000</td><td>27</td><td>6906</td><td>2882</td><td>US-VRA-210401 VRA145087_VRAYLAR Metabolics Enterprise NRW Email - Updated.US-VRA-210401 VRA145087_VRAYLAR Metabolics Enterprise Email - Updated</td><td>\"{\"\"Campaign Run ID\"\":\"\"10171\"\"</td></tr><tr><td>862949883</td><td>15773134</td><td>2022-07-09T17:53:48.000+0000</td><td>10</td><td>6906</td><td>2882</td><td>US-VRA-210401 VRA145087_VRAYLAR Metabolics Enterprise NRW Email - Updated.US-VRA-210401 VRA145087_VRAYLAR Metabolics Enterprise Email - Updated</td><td>\"{\"\"Campaign Run ID\"\":\"\"10171\"\"</td></tr><tr><td>863306120</td><td>1021127</td><td>2022-07-11T04:44:38.000+0000</td><td>11</td><td>6085</td><td>2887</td><td>202206 - US-BYS-220002.US-BYS-220002 - Bystolic Savings Program HCP Email</td><td>\"{\"\"Campaign Run ID\"\":\"\"10106\"\"</td></tr><tr><td>863376700</td><td>44162663</td><td>2022-07-11T10:48:27.000+0000</td><td>11</td><td>6350</td><td>2676</td><td>202206 - US-QLP-220036.US-QLP-220036 ABV-HCP-ATP-001752-2-CRM-5</td><td>\"{\"\"Campaign Run ID\"\":\"\"10215\"\"</td></tr><tr><td>864005619</td><td>12044596</td><td>2022-07-11T16:17:52.000+0000</td><td>6</td><td>6291</td><td>2729</td><td>202206-US-DAV-220056-AHE-Dalvance Copay Email.US-DAV-220056 Copay Assistance Program CRM Email (DLV) 1</td><td>\"{\"\"Campaign Run ID\"\":10232</td></tr></tbody></table></div>"]}}],"execution_count":0},{"cell_type":"code","source":[""],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"87584df3-10fd-431c-84a7-18db6322b7ab"}},"outputs":[],"execution_count":0}],"metadata":{"application/vnd.databricks.v1+notebook":{"notebookName":"Databricks-basics-learning01csv","dashboards":[],"notebookMetadata":{"pythonIndentUnit":4},"language":"python","widgets":{},"notebookOrigID":682232180276071}},"nbformat":4,"nbformat_minor":0}
